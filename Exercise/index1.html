<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>joint plot</title>

    <script src="scatter_plot.js?2"></script>
    <script src="bar_plot.js?2"></script>

    <link rel="stylesheet" href="../styles/style.css" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        .fig {
            fill: #faf8f8;
        }

        table {
            border: 1px solid #d2bcbc;
            border-collapse: collapse;
        }

        td {
            border: 1px solid #d2bcbc;
            border-collapse: collapse;
            padding: 10px;
            width: 10vw;
        }

        .hidden {

            display: none;

        }
        .myDiv{
	        width: 220px;
            align-content: center;
            margin: 0 auto;
        }

    </style>
    <script src="../lib/d3.js"></script>
</head>
    <body style="display: flex; flex-direction: column; padding: 20px">


<div class="myDiv">

    <button onClick="tableToggle(0)" type="button" class="btn btn-outline-secondary">plot_1</button>
    <button onClick="tableToggle(1)" type="button" class="btn btn-outline-primary">Plot_2</button>
    <button onClick="tableToggle(2)" type="button" class="btn btn-outline-success">plot_3</button>
    <!-- <button onClick="tableToggle()">Open Graph1</button> -->

</div>
<div id="main" style="display: flex; flex-direction: column; align-items: center;  margin-top: 20px;">


        <!-- <svg id="my_dataviz" style = "margin-left:100px" height=200 width=300> </svg> -->
<!-- <div id= "legend" style = "position:fixed; left:80px; top:20px;">
      <svg id="my_dataviz" height=250 width=300> </svg>
    </div> -->


        <!-- <button onClick="tTable()">Open Table</button> -->

        <table style="margin: 5px" id="tbl1" class="hidden">
            <tr>

                <td><svg width="550px" height="150px" id="top1"></svg></td>
                <td width="10%">&nbsp</td>

            </tr>
            <tr>
                <td>


                    <svg id="my_dataviz" style="position:absolute;margin-left:250px;margin-top:-120px" height=200
                        width=300> </svg>


                    <svg width="550px" height="500px" viewBox="0 0 1100 1000" id="main1"></svg>

                </td>
                <td><svg width="150px" height="500px" id="right1"></svg></td>
            </tr>
        </table>
        <table style="margin: 5px; width: 600px" id="tbl2" class="hidden">
            <tr>
                <td><svg width="550px" height="150px" id="top2"></svg></td>
                <td width="10%">&nbsp</td>
            </tr>
            <tr>
                <td>

                    <svg id="my_dataviz" style="position:absolute;margin-left:250px;margin-top:-120px" height=200
                        width=300> </svg>

                    <svg width="550px" height="500px" viewBox="0 0 1100 1000" id="main2"></svg>
                </td>
                <td><svg width="150px" height="500px" id="right2"></svg></td>
            </tr>
        </table>
        <table style="margin: 5px; width: 600px" id="tbl3" class="hidden">
            <tr>
                <td><svg width="550px" height="150px" id="top3"></svg></td>
                <td width="10%">&nbsp</td>
            </tr>
            <tr>
                <td>

                    <svg id="my_dataviz" style="position:absolute;margin-left:250px;margin-top:-120px" height=200
                        width=300> </svg>

                    <svg width="550px" height="500px" viewBox="0 0 1100 1000" id="main3"></svg>
                </td>
                <td><svg width="150px" height="500px" id="right3"></svg></td>
            </tr>
        </table>

        </div>

        <script>
            let palmer_penguin_species = "../data/palmer_penguin_species.tsv";
            // loading data
            d3.tsv(palmer_penguin_species).then(main);

            // Subplots 1
            let fig1_main = d3
                .select("#main1")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // top svg 1
            let fig1_top = d3
                .select("#top1")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // right svg 1
            let fig1_right = d3
                .select("#right1")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");

            // Subplots 2

            let fig2_main = d3
                .select("#main2")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // top svg 2
            let fig2_top = d3
                .select("#top2")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // right svg 2
            let fig2_right = d3
                .select("#right2")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");

            // Subplots 3

            let fig3_main = d3
                .select("#main3")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // top svg 3
            let fig3_top = d3
                .select("#top3")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");
            // right svg 3
            let fig3_right = d3
                .select("#right3")
                .append("g")
                .append("rect")
                .attr("class", "fig")
                .attr("width", "100%")
                .attr("height", "100%");

            function main(data) {
                let spec = d3.map(data, function (d) {
                    return d.species;
                });
                let spec_t = new Set(spec);
                const iS = [...spec_t];
                var a1 = [];
                var a2 = [];
                var a3 = [];

                data.map((element) => {
                    if (element.species === iS[0]) {
                        a1.push(element);
                    } else if (element.species === iS[1]) {
                        a2.push(element);
                    } else if (element.species === iS[2]) {
                        a3.push(element);
                    }
                });

                var dict = {};
                dict[iS[0]] = a1;
                dict[iS[1]] = a2;
                dict[iS[2]] = a3;

                // fetch data from table
                let cl1 = d3.map(dict[iS[0]], function (d) {
                    return +d.culmen_length_mm;
                });
                let cd1 = d3.map(dict[iS[0]], function (d) {
                    return +d.culmen_depth_mm;
                });
                let fl1 = d3.map(dict[iS[0]], function (d) {
                    return +d.flipper_length_mm;
                });

                let cl2 = d3.map(dict[iS[1]], function (d) {
                    return +d.culmen_length_mm;
                });
                let cd2 = d3.map(dict[iS[1]], function (d) {
                    return +d.culmen_depth_mm;
                });
                let fl2 = d3.map(dict[iS[1]], function (d) {
                    return +d.flipper_length_mm;
                });

                let cl3 = d3.map(dict[iS[2]], function (d) {
                    return +d.culmen_length_mm;
                });
                let cd3 = d3.map(dict[iS[2]], function (d) {
                    return +d.culmen_depth_mm;
                });
                let fl3 = d3.map(dict[iS[2]], function (d) {
                    return +d.flipper_length_mm;
                });

                let iL = ["Torgersen", "Biscoe", "Dream"];

                let island_code = d3.map(dict[iS[0]], function (d) {
                    island = d.island;
                    if (island === "Torgersen") {
                        return 0;
                    } else if (island === "Dream") {
                        return 1;
                    } else {
                        return 2;
                    }
                });

                // main svg
                scatter_plot(
                    cd1,
                    cl1,
                    fl1,
                    island_code,
                    "main1",
                    (title = "Penguin Species"),
                    (xLabel = "culmen_depth_mm"),
                    (yLabel = "culmen_length_mm")
                );
                //#############
                bar_plot(cd1, 10, "top1");
                h_bar_plot(cl1, 10, "right1");

                scatter_plot(
                    cd2,
                    cl2,
                    fl2,
                    island_code,
                    "main2",
                    (title = "Penguin Species"),
                    (xLabel = "culmen_depth_mm"),
                    (yLabel = "culmen_length_mm")
                );
                //#############
                bar_plot(cd2, 10, "top2");
                h_bar_plot(cl2, 10, "right2");

                scatter_plot(
                    cd3,
                    cl3,
                    fl3,
                    island_code,
                    "main3",
                    (title = "Penguin Species"),
                    (xLabel = "culmen_depth_mm"),
                    (yLabel = "culmen_length_mm")
                );
                //#############
                bar_plot(cd3, 10, "top3");
                h_bar_plot(cl3, 10, "right3");
            }

            function tableToggle(value) {
                d3.select("#tbl1").attr("style", value === 0 ? "display: table" : "display: none");
                d3.select("#tbl2").attr("style", value === 1 ? "display: table" : "display: none");
                d3.select("#tbl3").attr("style", value === 2 ? "display: table" : "display: none");


            }

            var svg = d3.select("#my_dataviz")

            // Handmade legend
            svg.append("circle").attr("cx", 200).attr("cy", 130).attr("r", 5).style("fill", "#4682b4")
            svg.append("circle").attr("cx", 200).attr("cy", 150).attr("r", 5).style("fill", "#76566f")
            svg.append("circle").attr("cx", 200).attr("cy", 170).attr("r", 5).style("fill", "#a52a2a")
            svg.append("text").attr("x", 220).attr("y", 130).text("Torgersen").style("font-size", "15px").style("fill", "#4682b4").attr("alignment-baseline", "middle")
            svg.append("text").attr("x", 220).attr("y", 150).text("Biscoe").style("font-size", "15px").style("fill", "#76566f").attr("alignment-baseline", "middle")
            svg.append("text").attr("x", 220).attr("y", 170).text("Dream").style("font-size", "15px").style("fill", "#a52a2a").attr("alignment-baseline", "middle")

        </script>

</body>

</html>